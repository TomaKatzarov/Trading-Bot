{
  "hpo_config": {
    "study_name": "HPO_GRU_Production",
    "sampler": "tpe",
    "pruner": "median",
    "n_trials": 100,
    "target_metric": "validation_f1_score_positive_class",
    "direction": "maximize",
    "storage_url": null,
    "output_dir": "hpo_results",
    "models_to_optimize": [
      "mlp",
      "lstm",
      "gru",
      "cnn_lstm"
    ],
    "pregenerated_data_path": "C:\\TradingBotAI\\data\\training_data_v2_final"
  },
  "raw_hpo_config": {
    "experiment_config": {
      "name": "HPO_GRU_Production",
      "stage": "HPO",
      "purpose": "optimize_gru_addressing_overfitting_and_recall",
      "n_trials": 75,
      "timeout_hours": 25
    },
    "data_config": {
      "pregenerated_path": "data/training_data_v2_final",
      "lookback_window": 24,
      "num_workers": 8
    },
    "model_config": {
      "type": "gru",
      "hidden_size": {
        "type": "categorical",
        "values": [
          64,
          96,
          128,
          192
        ]
      },
      "num_layers": {
        "type": "categorical",
        "values": [
          1,
          2,
          3
        ]
      },
      "dropout": {
        "type": "float",
        "low": 0.3,
        "high": 0.7
      },
      "attention_dim": {
        "type": "categorical",
        "values": [
          32,
          48,
          64,
          96
        ]
      },
      "bidirectional": {
        "type": "categorical",
        "values": [
          false,
          true
        ]
      }
    },
    "training_config": {
      "epochs": 100,
      "batch_size": {
        "type": "categorical",
        "values": [
          64,
          128,
          256
        ]
      },
      "learning_rate": {
        "type": "loguniform",
        "low": 0.0001,
        "high": 0.002
      },
      "optimizer": "adamw",
      "weight_decay": {
        "type": "float",
        "low": 0.01,
        "high": 0.1
      },
      "gradient_clip_norm": {
        "type": "categorical",
        "values": [
          0.5,
          1.0,
          2.0
        ]
      },
      "early_stopping_patience": 15,
      "early_stopping_metric": "val_f1",
      "loss_function": "focal_loss",
      "focal_alpha": {
        "type": "float",
        "low": 0.15,
        "high": 0.45
      },
      "focal_gamma": {
        "type": "float",
        "low": 1.5,
        "high": 3.0
      }
    },
    "lr_scheduler_config": {
      "type": "reduce_on_plateau",
      "factor": 0.5,
      "patience": {
        "type": "int",
        "low": 5,
        "high": 10
      },
      "mode": "max"
    },
    "optimization": {
      "direction": "maximize",
      "metric": "val_f1",
      "secondary_objectives": [
        {
          "name": "overfitting_gap",
          "weight": -0.3,
          "formula": "train_f1 - val_f1"
        },
        {
          "name": "recall_weight",
          "weight": 0.5,
          "formula": "val_recall"
        }
      ]
    },
    "pruning": {
      "enabled": true,
      "patience": 10,
      "min_epochs": 15
    }
  },
  "base_config": {
    "model_type": "lstm",
    "experiment_name": "nn_training_default",
    "output_dir": "training/runs/default",
    "use_mlflow": true,
    "num_workers": 4,
    "data_config": {
      "symbols_config_path": "../config/symbols.json",
      "feature_list": [
        "open",
        "high",
        "low",
        "close",
        "volume",
        "vwap",
        "SMA_20",
        "EMA_12",
        "RSI_14",
        "MACD_line",
        "MACD_signal",
        "MACD_hist",
        "BB_upper",
        "BB_middle",
        "BB_lower",
        "BB_bandwidth",
        "DayOfWeek_sin",
        "DayOfWeek_cos",
        "sentiment_score_hourly_ffill"
      ],
      "lookback_window": 24,
      "profit_target": 0.05,
      "stop_loss_target": 0.02,
      "prediction_horizon_hours": 8,
      "train_ratio": 0.7,
      "val_ratio": 0.15,
      "test_ratio": 0.15,
      "scaling_method": "standard",
      "nan_handling_features": "ffill",
      "sample_weights_strategy": "balanced",
      "pregenerated_data_path": "C:\\TradingBotAI\\data\\training_data_v2_final"
    },
    "model_config": {
      "n_features": 23,
      "num_assets": 162,
      "asset_embedding_dim": 12,
      "lstm_hidden_dim": 97,
      "lstm_num_layers": 2,
      "attention_dim\u6781": 64,
      "dropout_rate": 0.16239780813448107,
      "use_layer_norm": false,
      "hidden_layers": 4,
      "hidden_dim_1": 161,
      "hidden_dim_2": 44,
      "hidden_dim_3": 17,
      "lookback_window": 24,
      "attention_dim": 45,
      "gru_hidden_dim": 39,
      "gru_num_layers": 1,
      "cnn_filters": [
        110,
        39
      ],
      "cnn_kernel_sizes": [
        3,
        3
      ],
      "cnn_stride": 1,
      "use_max_pooling": true
    },
    "training_config": {
      "epochs": 100,
      "batch_size": 128,
      "learning_rate": 0.0001329291894316216,
      "optimizer": "adamw",
      "weight_decay": 2.9380279387035354e-06,
      "scheduler": "reduce_on_plateau",
      "scheduler_factor": 0.6005575058716044,
      "scheduler_patience": 4,
      "gradient_clip_norm": 0.592630224331111,
      "early_stopping_patience": 8,
      "monitor_metric": "f1",
      "use_weighted_sampling": false,
      "use_amp": true,
      "log_confusion_matrix_freq": 5,
      "loss_function": {
        "type": "focal",
        "alpha": 0.28775434790932963,
        "gamma": 2.665440364437338
      }
    },
    "pregenerated_data_path": "C:\\TradingBotAI\\data\\training_data_v2_final",
    "use_pregenerated_data": true
  },
  "results_by_model": {
    "mlp": {
      "model_type": "mlp",
      "study_name": "HPO_GRU_Production_mlp",
      "n_trials": 100,
      "n_complete": 75,
      "n_pruned": 25,
      "n_failed": 0,
      "best_trial_number": 72,
      "best_value": 0.3550891316848764,
      "best_params": {
        "learning_rate": 0.00010726239398390772,
        "batch_size": 256,
        "weight_decay": 0.00021403056853653915,
        "dropout_rate": 0.27825319822974104,
        "focal_alpha": 0.8534979238472781,
        "focal_gamma": 0.5765070137941654,
        "scheduler_factor": 0.4257292734908578,
        "scheduler_patience": 5,
        "gradient_clip_norm": 3.697669796019419,
        "early_stopping_patience": 5,
        "hidden_layers": 4,
        "hidden_dim_1": 161,
        "hidden_dim_2": 44,
        "hidden_dim_3": 17,
        "asset_embedding_dim": 5
      },
      "param_importance": {
        "focal_alpha": 0.8768482363064514,
        "dropout_rate": 0.040015948950641325,
        "hidden_dim_3": 0.031205561369625396,
        "hidden_dim_1": 0.01381596773420375,
        "asset_embedding_dim": 0.007208849884539559,
        "focal_gamma": 0.006663510479505438,
        "scheduler_patience": 0.005488055444926742,
        "hidden_layers": 0.004315273184688957,
        "weight_decay": 0.0033221917221790327,
        "learning_rate": 0.0027403587072782967,
        "early_stopping_patience": 0.002568388256209757,
        "hidden_dim_2": 0.002055449288434081,
        "gradient_clip_norm": 0.0016930478971346927,
        "batch_size": 0.0012409842301005494,
        "scheduler_factor": 0.0008181765440813257
      },
      "study_direction": "MAXIMIZE",
      "convergence_data": null,
      "visualization_paths": []
    },
    "lstm": {
      "model_type": "lstm",
      "study_name": "HPO_GRU_Production_lstm",
      "n_trials": 100,
      "n_complete": 91,
      "n_pruned": 9,
      "n_failed": 0,
      "best_trial_number": 62,
      "best_value": 0.3286703096539162,
      "best_params": {
        "learning_rate": 5.742762779800407e-05,
        "batch_size": 128,
        "weight_decay": 1.3242860622144402e-06,
        "dropout_rate": 0.16208048169431025,
        "focal_alpha": 0.8733013094908448,
        "focal_gamma": 0.8533911013856688,
        "scheduler_factor": 0.38872609758264776,
        "scheduler_patience": 2,
        "gradient_clip_norm": 1.2078462481865948,
        "early_stopping_patience": 8,
        "lstm_hidden_dim": 202,
        "lstm_num_layers": 1,
        "attention_dim": 32,
        "asset_embedding_dim": 17,
        "use_layer_norm": false
      },
      "param_importance": {
        "focal_alpha": 0.8622753250831227,
        "lstm_hidden_dim": 0.06923800496222758,
        "attention_dim": 0.01678705241792576,
        "dropout_rate": 0.010174722376477935,
        "gradient_clip_norm": 0.008387562452135617,
        "early_stopping_patience": 0.007790466004674544,
        "weight_decay": 0.007019044883922553,
        "asset_embedding_dim": 0.004608093399749565,
        "learning_rate": 0.004237669900233255,
        "focal_gamma": 0.002771643328246402,
        "lstm_num_layers": 0.0023670601533168413,
        "scheduler_factor": 0.0016639756895734986,
        "use_layer_norm": 0.0016633896293814351,
        "scheduler_patience": 0.0007559952468001035,
        "batch_size": 0.00025999447221248525
      },
      "study_direction": "MAXIMIZE",
      "convergence_data": null,
      "visualization_paths": []
    },
    "gru": {
      "model_type": "gru",
      "study_name": "HPO_GRU_Production_gru",
      "n_trials": 100,
      "n_complete": 88,
      "n_pruned": 12,
      "n_failed": 0,
      "best_trial_number": 93,
      "best_value": 0.3339137081705453,
      "best_params": {
        "learning_rate": 0.00032195235589938616,
        "batch_size": 128,
        "weight_decay": 0.00037077231289477525,
        "dropout_rate": 0.3181755818276266,
        "focal_alpha": 0.8819695461894077,
        "focal_gamma": 1.5504037313742167,
        "scheduler_factor": 0.46946701434390703,
        "scheduler_patience": 5,
        "gradient_clip_norm": 1.2776184710190244,
        "early_stopping_patience": 3,
        "gru_hidden_dim": 39,
        "gru_num_layers": 1,
        "attention_dim": 61,
        "asset_embedding_dim": 4,
        "use_layer_norm": true
      },
      "param_importance": {
        "focal_alpha": 0.7957941501306365,
        "gru_hidden_dim": 0.10063356407213558,
        "learning_rate": 0.035470051447469224,
        "gradient_clip_norm": 0.019127397499261276,
        "weight_decay": 0.01421082081258866,
        "focal_gamma": 0.008900426206346403,
        "early_stopping_patience": 0.006348053769076324,
        "attention_dim": 0.005448082177697995,
        "scheduler_factor": 0.005344571558214281,
        "batch_size": 0.00457863517449186,
        "dropout_rate": 0.0025525542489637284,
        "asset_embedding_dim": 0.00079161442110425,
        "scheduler_patience": 0.00036254302900371436,
        "use_layer_norm": 0.0002654523770161684,
        "gru_num_layers": 0.00017208307599423167
      },
      "study_direction": "MAXIMIZE",
      "convergence_data": null,
      "visualization_paths": []
    },
    "cnn_lstm": {
      "model_type": "cnn_lstm",
      "study_name": "HPO_GRU_Production_cnn_lstm",
      "n_trials": 100,
      "n_complete": 100,
      "n_pruned": 0,
      "n_failed": 0,
      "best_trial_number": 0,
      "best_value": 0.0,
      "best_params": {
        "learning_rate": 0.0001329291894316216,
        "batch_size": 128,
        "weight_decay": 2.9380279387035354e-06,
        "dropout_rate": 0.16239780813448107,
        "focal_alpha": 0.28775434790932963,
        "focal_gamma": 2.665440364437338,
        "scheduler_factor": 0.6005575058716044,
        "scheduler_patience": 4,
        "gradient_clip_norm": 0.592630224331111,
        "early_stopping_patience": 8,
        "cnn_filters_1": 110,
        "cnn_filters_2": 39,
        "cnn_kernel_size_1": 3,
        "cnn_kernel_size_2": 3,
        "cnn_stride": 1,
        "use_max_pooling": true,
        "lstm_hidden_dim": 97,
        "lstm_num_layers": 2,
        "attention_dim": 45,
        "asset_embedding_dim": 12,
        "use_layer_norm": false
      },
      "param_importance": {},
      "study_direction": "MAXIMIZE",
      "convergence_data": null,
      "visualization_paths": []
    }
  },
  "timestamp": "2025-10-03T22:50:12.582276"
}